- name: dry-run-vanilla
  tags:
    - dry-run
  command: >
    snakemake
      --dryrun
      --reason
      --printshellcmds
      --config pepfile=tests/pep/project_config.yaml
      --snakefile Snakefile
  exit_code: 0
  stdout:
    contains:
      # Test wether the input bamfile is converted to fasta
      - samtools fasta tests/data/GM24385_ASL.bam 2> log/GM24385_ASL_bam_to_fasta.txt | gzip > GM24385_ASL/GM24385_ASL.fasta.gz
    contains_regex:
      # Test wether hifiasm-flags are included in the command
      - hifiasm -o GM24385_ASL/GM24385_ASL .* -f0
    must_not_contain:
      - rror
  stderr:
    must_not_contain:
      - rror

# Test wether it is possible to leave out the "HiFi-assembly" section
- name: dry-run-no-HiFi-assembly-section
  tags:
    - dry-run
  command: >
    snakemake
      --dryrun
      --reason
      --printshellcmds
      --config pepfile=tests/pep/project_config_no_HiFi-assembly_section.yaml
      --snakefile Snakefile
  exit_code: 0
  stdout:
    must_not_contain:
      - rror
  stderr:
    must_not_contain:
      - rror
